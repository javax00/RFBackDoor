# RFBACKDOOR TRELLO
# https://trello.com/b/1VxztfrH/rfbackdoor-site-development
# RFBACKDOOR S3
# https://s3.console.aws.amazon.com/s3/home?region=us-west-1#

specs = {'Description': '1',
		'Frequency (min)': '2',
		'Frequency (max)': '3',
		'Frequency 2 (min)': '4',
		'Frequency 2 (max)': '5',
		'Waveguide Type': '6',
		'Coax Type': '7',
		'Configuration': '8',
		'Flange Type': '9',
		'VSWR (single value or input/output)': '10',
		'Connector 1 Type': '11',
		'Connector 2 Type': '12',
		'Connector 1 gender': '13',
		'Connector 2 gender': '14',
		'Insertion loss (min)': '15',
		'Insertion loss (max)': '16',
		'Insertion loss 2 (min)': '17',
		'Insertion loss 2 (max)': '18',
		'Impedance': '19',
		'Package': '20',
		'Saturated Power (Psat)': '21',
		'Gain (min)': '22',
		'Gain (max)': '23',
		'Noise Figure': '24',
		'P1dB (dBm)': '25',
		'IP3': '26',
		'Voltage (min)': '27',
		'Voltage (max)': '28',
		'Current (min)': '29',
		'Current (max)': '30',
		'Control Type': '31',
		'Max Input Power': '32',
		'Output Power': '33',
		'Dynamic Range': '34',
		'Gain Flatness': '35',
		'Phase Noise (min)': '36',
		'Phase Noise (max)': '37',
		'PAE': '38',
		'Return Loss': '39',
		'Bandwidth': '40',
		'Bandwidth 2': '41',
		'Slew rate': '42',
		'Attenuation (min)': '43',
		'Attenuation (max)': '44',
		'Attenuation Range': '45',
		'Attenuation Step Size': '46',
		'Accuracy': '47',
		'Switching Speed': '48',
		'Control Voltage (min)': '49',
		'Control Voltage (max)': '50',
		'Breakdown Voltage': '51',
		'Number of Channels': '52',
		'Amplitude Balance': '53',
		'Phase Balance': '54',
		'Common Mode Rejection': '55',
		'Rise Time': '56',
		'Fall Time': '57',
		'Impedance Ratio': '58',
		'Interface': '59',
		'Isolation': '60',
		'Length': '61',
		'Amplitude Stability': '62',
		'Phase Stability': '63',
		'Phase Deviation': '64',
		'Capacitance (min)': '65',
		'Capacitance (max)': '66',
		'Tuning Ratio': '67',
		'Tuning Voltage (min)': '68',
		'Tuning Voltage (max)': '69',
		'Q Factor (min)': '70',
		'Q Factor (max)': '71',
		'Frequency Band': '72',
		'Coupling': '73',
		'Directivity': '74',
		'Average Power': '75',
		'Amplitude Flatness': '76',
		'Pick Off Loss': '77',
		'Coupling Port Type': '78',
		'Data Rate (input/output)': '79',
		'Single-ended Amplitude': '80',
		'Differential Amplitude': '81',
		'Group Delay': '82',
		'Propogation Delay': '83',
		'Pulse width': '84',
		'Center Frequency': '85',
		'Center Frequency 2': '86',
		'Rejection': '87',
		'Passband Frequency (min)': '88',
		'Passband Frequency (max)': '89',
		'Lower Passband Frequency (min)': '90',
		'Lower Passband Frequency (max)': '91',
		'Mid Passband Frequency (min)': '92',
		'Mid Passband Frequency (max)': '93',
		'Upper Passband Frequency (min)': '94',
		'Upper Passband Frequency (max)': '95',
		'Stopband Frequency (min)': '96',
		'Stopband Frequency (max)': '97',
		'Lower Stopband Frequency (min)': '98',
		'Lower Stopband Frequency (max)': '99',
		'Upper Stopband Frequency (min)': '100',
		'Upper Stopband Frequency (max)': '101',
		'Tuning Frequency (min)': '102',
		'Tuning Frequency (max)': '103',
		'Lower Stopband Rejection': '104',
		'Mid Stopband Rejection': '105',
		'Upper Stopband Rejection': '106',
		'Passband Insertion Loss': '107',
		'Lower Passband Insertion Loss': '108',
		'Mid Passband Insertion Loss': '109',
		'Upper Passband Insertion Loss': '110',
		'Passband Return Loss': '111',
		'Lower Passband Return Loss': '112',
		'Mid Passband Return Loss': '113',
		'Upper Passband Return Loss': '114',
		'Control Current (min)': '115',
		'Control Current (max)': '116',
		'Absolute Delay': '117',
		'EIA Standard': '118',
		'UK Standard': '119',
		'IEC Standard': '120',
		'Input Frequency (min)': '121',
		'Input Frequency (max)': '122',
		'Output Frequency (min)': '123',
		'Output Frequency (max)': '124',
		'Conversion Loss': '125',
		'Conversion Gain': '126',
		'Fundamental Suppression (F)': '127',
		'3rd Harmonic Suppression (3F)': '128',
		'Input Power Level (min)': '129',
		'Input Power Level (max)': '130',
		'Bias Voltage': '131',
		'Divide Ratio (min)': '132',
		'Divide Ratio (max)': '133',
		'Multiplication Factor': '134',
		'GaN Type': '135',
		'Template Line': '136',
		'Macrodefect Density': '137',
		'Resistivity': '138',
		'Thickness Variation': '139',
		'Inductance': '140',
		'LO/RF Frequency (min)': '141',
		'LO/RF Frequency (max)': '142',
		'RF Frequency (min)': '143',
		'RF Frequency (max)': '144',
		'LO Frequency (min)': '145',
		'LO Frequency (max)': '146',
		'IF Frequency (min)': '147',
		'IF Frequency (max)': '148',
		'LO Power (min)': '149',
		'LO Power (max)': '150',
		'Control Frequency (min)': '151',
		'Control Frequency (max)': '152',
		'Frequency Hopping Step': '153',
		'LO/RF Isolation': '154',
		'LO/IF Isolation': '155',
		'RF/IF Isolation': '156',
		'Image Rejection': '157',
		'Spurious Rejection': '158',
		'Carrier Rejection': '159',
		'Sideband Rejection': '160',
		'Harmonic Rejection': '161',
		'Noise Spectral Density': '162',
		'Insertion Loss Ripple': '163',
		'Output Driver Frequency (min)': '164',
		'Output Driver Frequency (max)': '165',
		'Harmonic Level (min)': '166',
		'Harmonic Level (max)': '167',
		'Pulling': '168',
		'Pushing': '169',
		'Phase Range': '170',
		'Drain Voltage (min)': '171',
		'Drain Voltage (max)': '172',
		'Gate Voltage (min)': '173',
		'Gate Voltage (max)': '174',
		'Drain Current (min)': '175',
		'Drain Current (max)': '176',
		'Gate Current (min)': '177',
		'Gate Current (max)': '178',
		'Scale Factor': '179',
		'Phase Shifter Bits': '180',
		'Phase Shifter Range (min)': '181',
		'Phase Shifter Range (max)': '182',
		'Step Attenuator Bits': '183',
		'Step Attenuator Range (min)': '184',
		'Step Attenuator Range (max)': '185',
		'Phase Error': '186',
		'Amplitude Error': '187',
		'Peak Power (min)': '188',
		'Peak Power (max)': '189',
		'RF Prescaler': '190',
		'Reference Frequency (min)': '191',
		'Reference Frequency (max)': '192',
		'PFD Frequency (min)': '193',
		'PFD Frequency (max)': '194',
		'Temperature Range': '195',
		'Sensitivity': '196',
		'Polarity': '197',
		'Detectable Power Level (min)': '198',
		'Detectable Power Level (max)': '199',
		'Output Voltage (min)': '200',
		'Output Voltage (max)': '201',
		'Power Split': '202',
		'Power Combine': '203',
		'Power Limit': '204',
		'Flat Leakage': '205',
		'Speed': '206',
		'Power Ratio': '207',
		'Amplitude Ratio': '208',
		'Phase Ratio': '209',
		'Shape': '210',
		'Channel': '211',
		'Ports': '212',
		'Number of Switches': '213',
		'Switch Type': '214',
		'Life Cycle': '215',
		'Plane': '216',
		'Resolution': '217',
		'Spur Level': '218',
		'VCO Voltage': '219',
		'VCO Current': '220',
		'Settling Time': '221',
		'Clock Frequency (min)': '222',
		'Clock Frequency (max)': '223',
		'Tuning Word Width': '224',
		'Full Scale DAC Output Current': '225',
		'PLL Type': '226',
		'Drain Efficiency': '227',
		'Quiescent Drain Current': '228',
		'TX Frequency (min)': '229',
		'TX Frequency (max)': '230',
		'TX Gain': '231',
		'RX Gain': '232',
		'Sample Rate': '233',
		'SINAD': '234',
		'SFDR': '235',
		'Switching Frequency': '236',
		'Max Twist': '237',
		'Features': '238',
		'Channel Spacing': '239',
		'Control Bits': '240',
		'Data out Interface': '241',
		'Device Match': '242',
		'Gain Step': '243',
		'Num Outputs': '244',
		'Output Divider Frequency (min)': '245',
		'Output Divider Frequency (max)': '246',
		'P01db': '247',
		'Power': '248',
		'Resolution Bits': '249',
		'Response Time': '250',
		'Voltage Span (min)': '251',
		'Voltage Span (max)': '252',
		'P1dB (watts)': '253',
		'Connector 1 Body Style': '254',
		'Connector 2 Body Style': '255',
		'Connector 1 Mount': '256',
		'Connector 2 Mount': '257',
		'Connector 1 Impedance': '258',
		'Connector 2 Impedance': '259',
		'Connector 1 Polarity': '260',
		'Connector 2 Polarity': '261',
		'Connector 1 Connection Method': '262',
		'Connector 2 Connection Method': '263',
		'Polarization': '264',
		'Radome Material': '265',
		'Phase Adjustments': '266',
		'DC Port Gender': '267',
		'DC Port Series': '268',
		'Bend Radius': '269',
		'Number of Shields': '270',
		'Jacket Material': '271',
		'Propagation Velocity': '272',
		'Termination Type': '273',
		'Flange Type 2': '274',
		'Flange Type 3': '275',
		'Recovery Time': '276',
		'Rotation Speed': '277',
		'CW Input Power (dBm)': '278',
		'Rx Frequency (min)': '279',
		'Rx Frequency (max)': '280',
		'Stability': '281',
		'Gain Control Range': '282',
		'RX Output Power': '283',
		'TX Output Power': '284'}

manu = {1: 'Agile Microwave Technology',
		2: 'Agile Microwave Technology',
		3: 'A.H. Systems, Inc.',
		4: 'Amcom Communications',
		5: 'American Technical Ceramics',
		6: 'Ampleon',
		7: 'Amplical',
		8: 'Analog Devices',
		9: 'Anatech Electronics, Inc',
		10: 'Anaren',
		11: 'Anokiwave',
		12: 'API Technologies',
		13: 'Atlanta Micro',
		14: 'Atlantic Microwave',
		15: 'Bird Technologies',
		16: 'Centric RF',
		17: 'Cernex',
		18: 'Ciao Wireless',
		19: 'CMC (Custom Microwave Components)',
		20: 'Coilcraft',
		21: 'Coleman Microwave Company',
		22: 'ComNav Engineering',
		23: 'Corry Micronics, Inc.',
		24: 'CPI Beverly Microwave Division',
		25: 'Custom MMIC',
		26: 'DBwave Technologies LLC',
		27: 'Diamond Microwave',
		28: 'Ducommun',
		29: 'Electromagnetic Technologies (ET) Industries',
		30: 'Empower RF',
		31: 'Epec',
		32: 'Erzia',
		33: 'Exceed Microwave',
		34: 'Fairview Microwave',
		35: 'Filtronetics Inc.',
		36: 'Greenray Industries',
		37: 'Guerrilla-RF',
		38: 'Herotek',
		39: 'Inductor Supply',
		40: 'Infineon',
		41: 'INSTOCK Wireless Components, Inc.',
		42: 'Integra Technologies, Inc.',
		43: 'Renesas',
		44: 'JFW Industries',
		45: 'K&L Microwave',
		46: 'Kaelus',
		47: 'Krohn-Hite Corporation',
		48: 'Krytar',
		49: 'Macom',
		50: 'Marki Microwave',
		51: 'Maxim Integrated',
		52: 'MCV Microwave',
		53: 'MECA Electronics, Inc.',
		54: 'MegaPhase',
		55: 'Mercury Systems',
		56: 'Micro Lambda Wireless, Inc.',
		57: 'Microchip',
		58: 'Microwave Filter Company, Inc.',
		59: 'Mini-Circuits',
		60: 'Morion US',
		61: 'MtronPTI',
		62: 'Murata',
		63: 'National Instruments',
		64: 'Netcom',
		65: 'Nexyn Corporation',
		66: 'NF Corporation',
		67: 'Norden Millimeter',
		68: 'NuWaves Engineering',
		69: 'OML',
		70: 'P1dB',
		71: 'Passive Plus',
		72: 'Pasternack',
		73: 'Planar Monolithics Industries',
		74: 'Pletronics',
		75: 'Pole Zero',
		76: 'PolyPhaser',
		77: 'pSemi Corporation',
		78: 'Q Microwave',
		79: 'Qorvo',
		80: 'Raltron',
		81: 'Reactel',
		82: 'RFHIC',
		83: 'RF-Lambda',
		84: 'RF Superstore',
		85: 'Rohde & Schwarz',
		86: 'Eravant',
		87: 'Sinclair Technologies',
		88: 'Skyworks Solutions Inc.',
		89: 'Smiths Interconnect',
		90: 'Space Vector',
		91: 'Spacek Labs',
		92: 'Synergy Microwave Corporation',
		93: 'Teledyne Microwave Solutions',
		94: 'Texas Instruments',
		95: 'United Monolithic Semiconductors (UMS)',
		96: 'Wainwright Instruments',
		97: 'Waveline Solid State',
		98: 'Weinschel Associates',
		99: 'Werlatone',
		100: 'Wolfspeed',
		101: 'XMA Corp'}

cat = {1: 'Adapter',
		2: 'Amplifier',
		3: 'Antenna',
		4: 'Attenuator',
		5: 'Balun',
		6: 'Bias-Tee',
		7: 'Cable',
		8: 'Calibration-Kit',
		9: 'Capacitor',
		10: 'Circulator',
		11: 'Coupler',
		12: 'Data-Module',
		13: 'DC-Block',
		14: 'Driver',
		15: 'Duplexer',
		16: 'Filter',
		17: 'Flange-Drawing',
		18: 'Frequency-Divider',
		19: 'GaN-Wafer',
		20: 'Inductor',
		21: 'Isolator',
		22: 'Load',
		23: 'Mixer',
		24: 'Multiplexer',
		25: 'Multiplier',
		26: 'Oscillator',
		27: 'Other',
		28: 'Phase-Detector',
		29: 'Phase-Shifter',
		30: 'PLL',
		31: 'Power-Detector',
		32: 'Power-Divider',
		33: 'Power-Limiter',
		34: 'Power-Joint',
		35: 'Rotary-Joint',
		36: 'Switch',
		37: 'Synthesizer',
		38: 'Transistor',
		39: 'Tx-Rx-Module',
		40: 'Voltage-Regulator',
		41: 'Waveguide',
		42: 'Combiner',
		43: 'Connector'}


from tkinter import *
from tkinter import scrolledtext, messagebox
from tkinter.filedialog import askopenfilename
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium import webdriver
from datetime import datetime
from bs4 import BeautifulSoup
from applescript import tell
from subprocess import *
import urllib.request
import pandas as pd
import requests
import getpass
import kthread
import urllib
import shutil
import random
import json
import time
import glob
import sys
import os

root = Tk()
root.withdraw()

def onClicked():
	global filename
	lis = []

	# local, staging, production
	destination = 'staging'

	folderName = '-'.join(filename.split('/')[-1].split('_')[0:-2])
	print(folderName+" is now uploading . . .")

	username = getpass.getuser()
	upImg = '/Users/'+username+'/Work/RFBackDoor/Images/'+folderName

	df = pd.read_csv(filename, low_memory=False)

	options = Options()
	options.add_argument("--headless")
	options.add_argument('--no-sandbox')
	options.add_argument('--disable-gpu')
	options.add_argument('start-maximized')
	options.add_argument('disable-infobars')
	options.add_argument("--disable-extensions")
	options.add_argument("--disable-software-rasterizer")
	prefs = {'download.default_directory' : '/Users/'+username+'/Work/RFBackDoor/Images/'+folderName}
	options.add_experimental_option('prefs', prefs)

	global driver
	driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()), options=options)

	for i in df.index:
		data, dataSpec, lisSpec = {}, {}, []
		pn, m, c, sc, im, p, pl = '', '', '', '', '', '', ''
		for x in df:
			if x == 'Part Number':
				if str(df[x][i])[-2:] == '.0':
					pn = str(df[x][i])[:-2]
				else:
					pn = str(df[x][i])
			elif x == 'Manufacturer':
				if str(df[x][i])[-2:] == '.0':
					m = int(str(df[x][i])[:-2])
				else:
					m = int(df[x][i])
			elif x == 'Category':
				if str(df[x][i])[-2:] == '.0':
					c = int(str(df[x][i])[:-2])
				else:
					c = int(df[x][i])
			elif x == 'Subcategory':
				if str(df[x][i])[-2:] == '.0':
					sc = int(str(df[x][i])[:-2])
				else:
					sc = int(df[x][i])
			elif x == 'Image':
				if str(df[x][i])[-2:] == '.0':
					im = str(df[x][i])[:-2].replace(' ', '%20')
				else:
					im = str(df[x][i]).replace(' ', '%20')
			elif x == 'PDF':
				if str(df[x][i])[-2:] == '.0':
					p = str(df[x][i])[:-2].replace(' ', '%20')
				else:
					p = str(df[x][i]).replace(' ', '%20')
			elif x == 'Product Link':
				if str(df[x][i])[-2:] == '.0':
					pl = str(df[x][i])[:-2].replace(' ', '%20')
				else:
					pl = str(df[x][i]).replace(' ', '%20')
			else:
				if str(df[x][i]) != 'nan':
					temp = {}
					temp['specification'] = str(specs[x])

					if str(df[x][i])[-2:] == '.0':
						temp['value'] = str(df[x][i])[:-2]
					else:
						temp['value'] = str(df[x][i])
					lisSpec.append(temp)

		data['product_partnumber'] = pn.replace('"','')
		data['manufacturer'] = m
		data['category'] = c
		data['subcategory'] = sc
		##########
		driver.get('data:,')
		if str(im) == 'nan':
			data['image_link'] = ''
		elif str(im).split('.')[-1] == 'com' or str(im).split('.')[-1] == 'com/':
			data['image_link'] = ''
		else:
			new_name = ''
			skp = 0

			unqId = str(m)+str(c)+str(sc)+str(datetime.now().strftime('%Y%m%d%H%M%S%f'))+str(i).zfill(5)
			ext = im.split('?')[0].split('.')[-1]

			finalPath = '/Users/'+username+'/Work/RFBackDoor/Images/'+folderName+'/'+cat[c]
			if not os.path.exists(finalPath):
				os.makedirs(finalPath)

			if folderName == 'Ampleon':
				ag = 0
				while ag == 0:
					try:
						r = requests.get(im)
						ag = 1
					except Exception as e:
						ag = 0
						time.sleep(2)

				with open(finalPath+'/'+unqId+'.'+ext, 'wb') as f:
					f.write(r.content)
				new_name = finalPath+'/'+unqId+'.'+ext
			else:
				urlA = 0
				while urlA == 0:
					try:
						driver.get(im)
						urlA = 1
					except Exception:
						urlA = 0

				# ANALOG
				try:
					if driver.find_element(By.TAG_NAME, 'body').text != '':
						try:
							driver.find_element_by_link_text("Accept and proceed").click()
							print('warning pop-up')
						except Exception as e:
							print('good')
							skp = 1
				except Exception:
					pass

				try:
					try:
						if skp == 1:
							data['image_link'] = ''
						else:
							img = driver.find_element(By.TAG_NAME, 'img')

							# 1
							if folderName == 'Fairview-Microwave' or folderName == 'Pasternack' or folderName == 'Bel-Fuse' or folderName == 'Macom' or folderName == 'Marki-Microwave' or folderName == 'Skyworks':
								with open(finalPath+'/'+unqId+'.png', 'wb') as file:
									file.write(driver.find_element(By.TAG_NAME, 'img').screenshot_as_png)
									new_name = finalPath+'/'+unqId+'.png'
							# 2
							elif folderName == 'UMS':
								time.sleep(.2)
								with open(finalPath+'/'+unqId+'.png', 'wb') as file:
									file.write(driver.find_element(By.TAG_NAME, 'img').screenshot_as_png)
									new_name = finalPath+'/'+unqId+'.png'
							# 3
							elif folderName == 'Mini-Circuit' or folderName == 'Texas-Instrument':
								time.sleep(.5)
								with open(finalPath+'/'+unqId+'.png', 'wb') as file:
									file.write(driver.find_element(By.TAG_NAME, 'img').screenshot_as_png)
									new_name = finalPath+'/'+unqId+'.png'
							# else:
								ag = 0
								while ag == 0:
									try:
										r = requests.get(im)
										ag = 1
									except Exception as e:
										ag = 0
										time.sleep(2)
								with open(finalPath+'/'+unqId+'.'+ext, 'wb') as f:
									f.write(r.content)
									new_name = finalPath+'/'+unqId+'.'+ext
						driver.get('data:,')
					except Exception:
						try:
							driver.find_element(By.TAG_NAME, 'svg')
							with open(finalPath+'/'+unqId+'.png', 'wb') as file:
								file.write(driver.find_element(By.TAG_NAME, 'svg').screenshot_as_png)

							new_name = finalPath+'/'+unqId+'.png'
							driver.get('data:,')
						except Exception:
							int("string")
					time.sleep(.2)

				except Exception as e:

					time.sleep(2)
					chkDL = 0
					while chkDL == 0:

						gf = 0
						while gf == 0:
							try:
								list_of_files = glob.glob('/'.join(finalPath.split('/')[0:-1])+'/*')
								latest_file = max(list_of_files, key=os.path.getmtime)
								gf = 1
							except Exception:
								gf = 0

						if 'tmp' in str(latest_file):
							print('downloading na...')
							time.sleep(1)
							chkDL = 0
						elif 'crdownload' in str(latest_file):
							time.sleep(1)
							try:
								os.rename(latest_file, '.'.join(latest_file.split('.')[0:-1]))
							except Exception as e:
								print(e)
							time.sleep(1)
							chkDL = 0
						else:
							if folderName == 'Fairview-Microwave' or folderName == 'Pasternack':
								skp = 1
							else:
								if '.' not in str(latest_file) and (folderName == 'Analog-Devices' or folderName == 'Qorvo'):
									print('looking...')
									for k in list_of_files:
										if '.' in k:
											latest_file = k
								try:
									new_name = finalPath+'/'+unqId+'.'+latest_file.split('.')[1]

									try:
										os.rename(latest_file, new_name)
									except Exception:
										os.remove(new_name)
										os.rename(latest_file, new_name)
									chkDL = 1
									time.sleep(1)
								except Exception as e:
									chkDL = 1
									skp = 1
				driver.get('data:,')
			if skp == 1:
				data['image_link'] = ''
			else:
				# CHANGE
				if destination == 'local':
					data['image_link'] = 'https://rbd-img.s3.us-west-1.amazonaws.com/rfbackdoor-product-imgs-sample/'+folderName+'/'+cat[c]+'/'+str(new_name.split('/')[-1])
				elif destination == 'staging':
					data['image_link'] = 'https://rbd-img.s3.us-west-1.amazonaws.com/rfbackdoor-product-imgs-staging/'+folderName+'/'+cat[c]+'/'+str(new_name.split('/')[-1])
				elif destination == 'production':
					data['image_link'] = 'https://rbd-img.s3.us-west-1.amazonaws.com/rfbackdoor-product-imgs-production/'+folderName+'/'+cat[c]+'/'+str(new_name.split('/')[-1])
		##########
		if str(p) == 'nan':
			data['pdf_link'] = ''
		else:
			data['pdf_link'] = p

		if str(pl) == 'nan':
			data['product_link'] = ''
		else:
			data['product_link'] = pl
		data['specifications'] = lisSpec
		lis.append(data)

		print('['+str(i+1)+'/'+str(len(df))+'] '+pn.replace('"',''))
		# print(json.dumps(data, indent = 4))
		# print(data)

	# CHANGE
	if destination == 'local':
		yourCommand = 'aws s3 cp '+upImg+' s3://rbd-img/rfbackdoor-product-imgs-sample/'+upImg.split('/')[-1]+' --recursive'
	elif destination == 'staging':
		yourCommand = 'aws s3 cp '+upImg+' s3://rbd-img/rfbackdoor-product-imgs-staging/'+upImg.split('/')[-1]+' --recursive'
	elif destination == 'production':
		yourCommand = 'aws s3 cp '+upImg+' s3://rbd-img/rfbackdoor-product-imgs-production/'+upImg.split('/')[-1]+' --recursive'
	tell.app( 'Terminal', 'do script "' + yourCommand + '"')

	driver.quit()
	tot = str((len(lis)-1)/30).split('.')
	hun = int(tot[0])
	man = (len(lis)-1)%30

	u = open("/Users/b2y/Work/RFBackDoor/Files/assets/users.txt", "r")
	data = u.read()
	users = data.split('\n')

	s = open("/Users/b2y/Work/RFBackDoor/Files/assets/sites.txt", "r")
	data = s.read()
	sites = data.split('\n')

	c = 1
	hunC = 0
	manC = 1
	finalLis = []
	for x in range(len(lis)):
		userIndex = random.choice(users)
		siteIndex = random.choice(sites)

		headers = {
			'dnt': '1',
			'upgrade-insecure-requests': '1',
			'User-Agent': userIndex,
			'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
			'sec-fetch-site': 'same-origin',
			'sec-fetch-mode': 'navigate',
			'sec-fetch-user': '?1',
			'sec-fetch-dest': 'document',
			'referer': 'https://www.'+siteIndex+'/',
			'accept-language': 'en-GB,en-US;q=0.9,en;q=0.8',
			'Updgrade-Insecure-Requests': '1',
			'authority': siteIndex,
			'content-type': 'application/json'
		}

		# CHANGE
		if destination == 'local':
			headers.update({'Authorization': 'Token 3c676a5b59b0f938fee7faee6e2f287104903478'}) #STAGING
		elif destination == 'staging':
			headers.update({'Authorization': 'Token 3c676a5b59b0f938fee7faee6e2f287104903478'}) #STAGING
		elif destination == 'production':
			headers.update({'Authorization': 'Token 5e0eab1dc39e27f1a9c9f26affe2775a61e34ae8'}) #PRODUCTION

		if c <= 30:
			if hunC == hun:
				finalLis.append(lis[x])
				if manC == man:
					# print(finalLis)

					statCode = 0
					while statCode != 201:
						# CHANGE
						if destination == 'local':
							url = 'http://127.0.0.1:8000/v1/api/products/'
						elif destination == 'staging':
							url = 'https://rfbackdoor-backend-1.herokuapp.com/v1/api/products/'
						elif destination == 'production':
							url = 'https://rfbackdoor-production.herokuapp.com/v1/api/products/'

						try:
							r = requests.post(url, data=json.dumps(finalLis), headers=headers, timeout=30)
							print('Status Code: '+str('Good1' if r.status_code == 201 else 'Bad1'))
							print(str(x)+'-'+str(len(df)))
							# print(r)
							# print(r.text)
							# print(url)
							# print(finalLis)
							# print('~~~')

							statCode = r.status_code
							if statCode != 201:
								print(finalLis)
								print(r)
								time.sleep(7)
						except Exception:
							print('error try again')
							statCode = 0

					# FOR JSON FILE
					# with open(str(filename.split('/')[-1].split('.')[0])+' ('+str(x-(man-1))+'-'+str(x+1)+').json', 'w') as f:
					# 	json.dump(finalLis, f, indent=4)
					# 	# json.dump(finalLis, f)
				manC += 1
			else:
				finalLis.append(lis[x])
		else:
			hunC += 1
			# print(finalLis)

			statCode = 0
			while statCode != 201:
				# CHANGE
				if destination == 'local':
					url = 'http://127.0.0.1:8000/v1/api/products/'
				elif destination == 'staging':
					url = 'https://rfbackdoor-backend-1.herokuapp.com/v1/api/products/'
				elif destination == 'production':
					url = 'https://rfbackdoor-production.herokuapp.com/v1/api/products/'

				try:
					r = requests.post(url, data=json.dumps(finalLis), headers=headers, timeout=30)
					print('Status Code: '+str('Good' if r.status_code == 201 else 'Bad'))
					print(str(x)+'-'+str(len(df)))
					# print(r)
					# print(r.text)
					# print(url)
					# print(finalLis)
					# print('~~~')

					statCode = r.status_code
					if statCode != 201:
						print(finalLis)
						print(r)
						time.sleep(7)
				except Exception:
					print('error try again')
					statCode = 0

			# FOR JSON FILE
			# with open(str(filename.split('/')[-1].split('.')[0])+' ('+str(x-29)+'-'+str(x)+').json', 'w') as f:
			# 	json.dump(finalLis, f, indent=4)
			# 	# json.dump(finalLis, f)
			finalLis = []
			print('~~~~~')
			c = 1
			finalLis.append(lis[x])
			# time.sleep(10)
		c += 1

def main():
	global filename
	filename = askopenfilename()
	onClicked()

if __name__ == '__main__':
	main()